<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

    <link rel="stylesheet" type="text/css" media="screen" href="/includes/style.css"/>

    <!--[if IE]>
    <link rel="stylesheet" type="text/css" media="screen" href="/includes/style-ie.css"/>
    <![endif]-->

    <title>Cappuccino Blog   &raquo; Tutorials</title>

    <link rel="alternate" type="application/rss+xml" title="Cappuccino Blog RSS Feed" href="http://cappuccino.org/discuss/feed/" />
    <link rel="pingback" href="http://cappuccino.org/discuss/xmlrpc.php" />
	<link rel="shortcut icon" href="/images/favicon.png" type="image/png" />

    <meta name='robots' content='noindex,nofollow' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://cappuccino.org/discuss/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cappuccino.org/discuss/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 2.7" />


</head>
<body>

    <div id="headerWrapper">
        <div id="headerContent">
            <div id="navigation">
            
                    
                        <div class="navigationLink">
                            <a href="/">Home</a>
                        </div>
                        
                        <div class="navigationLink">
                            <a href="/learn/">Learn</a>
                        </div>
                        
                        <div class="navigationLink">
                            <a class="activeLink" href="/discuss/">
                            Discuss</a>
                            <div id="navigationMarker"></div>
                        </div>
                        
                        <div class="navigationLink">
                            <a href="/contribute/">Contribute</a>
                        </div>
                        
                        <div class="navigationLink">
                            <a href="/download/">Download</a>
                        </div>
                                    
            </div>
            <div id="cappuccinoAnchor">
                <a href="/"><img width="32" height="32" id="cappuccinoAnchorLogo" src="/images/cappuccino-small.png" alt=" " /></a>
                <a href="/">cappuccino.org</a>
            </div>
        </div>
    </div>
    
    <div id="topContentWrapper"></div>

    <div id="mainContentWrapper">
        <div id="mainContent">

	<div id="subNavigation">
		<ul>
		
            <h3>Discuss</h3>
                <ul>
                                        <li class="active"><a href="/discuss/">Cappuccino Blog</a></li>
                    <li><a href="http://www.reddit.com/r/Cappuccino/">Latest News</a></li>
                    <li><a href="/discuss/events/">Events</a></li>
                                        <li><a href="/discuss/list.php">Mailing List &amp; IRC</a></li>
                    <li><a href="/discuss/faq.php">Frequently Asked Questions</a></li>
                </ul>

			
			<!-- Author information is disabled per default. Uncomment and fill in your details if you want to use it.
			<li><h2>Author</h2>
			<p>A little something about you, the author. Nothing lengthy, just an overview.</p>
			</li>
			-->

			 <li>

						<p>You are currently browsing the archives for the Tutorials category.</p>

			
			</li> 
			<li class="categories"><h3>Categories</h3><ul>	<li class="cat-item cat-item-34"><a href="http://cappuccino.org/discuss/category/280-north/" title="View all posts filed under 280 North">280 North</a> (1)
</li>
	<li class="cat-item cat-item-3"><a href="http://cappuccino.org/discuss/category/cappuccino/" title="View all posts filed under Cappuccino">Cappuccino</a> (25)
<ul class='children'>
	<li class="cat-item cat-item-30"><a href="http://cappuccino.org/discuss/category/cappuccino/releases/" title="View all posts filed under Releases">Releases</a> (4)
</li>
	<li class="cat-item cat-item-27"><a href="http://cappuccino.org/discuss/category/cappuccino/tools/" title="View all posts filed under Tools">Tools</a> (5)
</li>
</ul>
</li>
	<li class="cat-item cat-item-5"><a href="http://cappuccino.org/discuss/category/events/" title="View all posts filed under Events">Events</a> (4)
</li>
	<li class="cat-item cat-item-13"><a href="http://cappuccino.org/discuss/category/objective-j/" title="View all posts filed under Objective-J">Objective-J</a> (3)
</li>
	<li class="cat-item cat-item-18 current-cat"><a href="http://cappuccino.org/discuss/category/tutorials/" title="View all posts filed under Tutorials">Tutorials</a> (10)
</li>
	<li class="cat-item cat-item-1"><a href="http://cappuccino.org/discuss/category/uncategorized/" title="View all posts filed under Uncategorized">Uncategorized</a> (2)
</li>
	<li class="cat-item cat-item-4"><a href="http://cappuccino.org/discuss/category/update/" title="View all posts filed under Update">Update</a> (3)
</li>
</ul></li>
			<li><h3>Archives</h3>
				<ul>
					<li><a href='http://cappuccino.org/discuss/2009/05/' title='May 2009'>May 2009</a></li>
	<li><a href='http://cappuccino.org/discuss/2009/04/' title='April 2009'>April 2009</a></li>
	<li><a href='http://cappuccino.org/discuss/2009/03/' title='March 2009'>March 2009</a></li>
	<li><a href='http://cappuccino.org/discuss/2009/02/' title='February 2009'>February 2009</a></li>
	<li><a href='http://cappuccino.org/discuss/2009/01/' title='January 2009'>January 2009</a></li>
	<li><a href='http://cappuccino.org/discuss/2008/12/' title='December 2008'>December 2008</a></li>
	<li><a href='http://cappuccino.org/discuss/2008/11/' title='November 2008'>November 2008</a></li>
	<li><a href='http://cappuccino.org/discuss/2008/10/' title='October 2008'>October 2008</a></li>
	<li><a href='http://cappuccino.org/discuss/2008/09/' title='September 2008'>September 2008</a></li>
				</ul>
			</li>


			<li>
				<form method="get" id="searchform" action="http://cappuccino.org/discuss/">
<label class="hidden" for="s">Search for:</label>
<div><input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>
			</li>

					</ul>
	</div>


            <div id="mainContentDetail">

		
 	   	  		<h2 class="pagetitle">Archive for the &#8216;Tutorials&#8217; Category</h2>
 	  

		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"><a href="http://cappuccino.org/discuss/category/tutorials/" >Newer Entries &raquo;</a></div>
		</div>

				<div class="post">
				<h3 id="post-104"><a href="http://cappuccino.org/discuss/2008/10/21/cappuccino-tools-%e2%80%9cpress%e2%80%9d/" rel="bookmark" title="Permanent Link to Cappuccino Tools: “press”">Cappuccino Tools: “press”</a></h3>
				<small>Tuesday, October 21st, 2008</small>

				<div class="entry">
					<p>In the third installment of the build tools series we tackle one of the most advanced build tools: &#8220;press&#8221;. Recall from the <a href="http://cappuccino.org/discuss/2008/10/06/the-cappuccino-build-tools/">overview</a> that &#8220;press&#8221; is a tool for stripping code and other optimizations. Additionally, it can convert an entire Objective-J application into a single pure JavaScript file, which we&#8217;ll see can be useful.</p>
<h3>press</h3>
<p>The primary goal of &#8220;press&#8221; is to strip unused code from your application and frameworks and perform other optimizations. It needs to know about the entire application, including your application code and the Cappuccino frameworks, in order to determine the dependencies and remove unused files. It is called with two parameters, the path to your application, and the output directory:</p>
<p><code>press root_directory output_directory</code></p>
<p>This will run &#8220;press&#8221; on your application located at root_directory, and output a similar but smaller version (with unused files stripped) at output_directory.</p>
<p>Additionally, there are several useful options:</p>
<ul>
<li><em>&#8208;&#8208;main path</em>: The relative path (from root_directory) to the main file (default: &#8216;main.j&#8217;)</li>
<li><em>&#8208&#8208frameworks path</em>: The relative path (from root_directory) to the frameworks directory (default: &#8216;Frameworks&#8217;)</li>
<li><em>&#8208&#8208png</em>: Run pngcrush on all PNGs (pngcrush must be installed!)</li>
<li><em>&#8208&#8208flatten</em>: Flatten all code into a single Application.js file and attempt to add script tag to index.html (useful for Adobe AIR and CDN deployment)</li>
<li><em>&#8208&#8208nostrip</em>: Don&#8217;t strip any files. Mostly useful for debugging.</li>
</ul>
<h3>&#8208&#8208flatten</h3>
<p>The most interesting of these options is &#8220;&#8208&#8208flatten&#8221;, which converts your application into a single pure JavaScript file that can be imported with a standard &#8220;script&#8221; tag. While the Objective-J load system is great in most scenarios, there are currently a few limitations that a pure JavaScript file helps overcome. Namely that the load system doesn&#8217;t work in Adobe AIR due to strict security restrictions, and the load system doesn&#8217;t work across domains, such as with a CDN, also due to browser security restrictions. By flattening all Objective-J code into a JavaScript file, we can use a standard script tag to load our application, which works cross-domain and in Adobe AIR.</p>
<h3>Internals</h3>
<p>If you&#8217;re interested in how &#8220;press&#8221; works, read on. It starts by loading your application while noting which global variables are defined in each file. It then &#8220;walks&#8221; along the dependency &#8220;graph&#8221;, including every imported file, with one important exception: framework imports like &#8220;import &lt;AppKit/AppKit.j&gt;&#8221; and &#8220;import &lt;Foundation/Foundation.j&gt;&#8221; are ignored since these types of imports would result in the entire framework (including unused files) being imported. Instead, press looks at the global dependencies, and only keeps the files that are referenced by any other file that has been imported.</p>
<h3>Conclusion</h3>
<p>&#8220;press&#8221; is a already a great tool, but there is much room for improvement. In the future we would like to add finer-granularity code stripping, such as method-level rather than file-level. Additionally, we&#8217;re working on an automatic <a href="http://www.alistapart.com/articles/sprites">image spriting</a> and optimization feature which determines exactly which images are required for your application and includes them in a single image, vastly reducing the number of HTTP requests to load your application.</p>
				</div>

				<p class="postmetadata">Tags: <a href="http://cappuccino.org/discuss/tag/build-tool/" rel="tag">build tool</a><br /> Posted in <a href="http://cappuccino.org/discuss/category/cappuccino/" title="View all posts in Cappuccino" rel="category tag">Cappuccino</a>,  <a href="http://cappuccino.org/discuss/category/cappuccino/tools/" title="View all posts in Tools" rel="category tag">Tools</a>,  <a href="http://cappuccino.org/discuss/category/tutorials/" title="View all posts in Tutorials" rel="category tag">Tutorials</a> |   <a href="http://cappuccino.org/discuss/2008/10/21/cappuccino-tools-%e2%80%9cpress%e2%80%9d/#comments" title="Comment on Cappuccino Tools: “press”"></a><noscript><a href="http://cappuccino.disqus.com/?url=http://cappuccino.org/discuss/2008/10/21/cappuccino-tools-%e2%80%9cpress%e2%80%9d/">View comments</a></noscript><a href="http://cappuccino.org/discuss/2008/10/21/cappuccino-tools-%e2%80%9cpress%e2%80%9d/#disqus_thread">Comments</a></a></p>

			</div>

				<div class="post">
				<h3 id="post-93"><a href="http://cappuccino.org/discuss/2008/10/14/objjc-and-steam/" rel="bookmark" title="Permanent Link to Cappuccino Tools: &#8220;objjc&#8221; and &#8220;steam&#8221;">Cappuccino Tools: &#8220;objjc&#8221; and &#8220;steam&#8221;</a></h3>
				<small>Tuesday, October 14th, 2008</small>

				<div class="entry">
					<p>In our previous post on the <a href="http://cappuccino.org/discuss/2008/10/06/the-cappuccino-build-tools/">Cappuccino build tools</a> we summarized the purpose of four of the tools. In this article we&#8217;ll dive deeper into two of them, objjc and steam.</p>
<p>To review, the purpose of these tools is to prepare your application for deployment by pre-compiling all application Objective-J code into JavaScript, thereby reducing the load time for clients. Additionally, since most developers won&#8217;t need to modify Cappuccino itself, we always compile Cappuccino&#8217;s AppKit and Foundation frameworks to further reduce load time.</p>
<p>The only time you&#8217;ll need to run steam (which handles running objjc for you) is when you&#8217;re deploying your application, or if you&#8217;re making changes to the Cappuccino frameworks themselves. In the latter case, the easiest way to recompile the frameworks is to run the default ant task in the Cappuccino source tree:</p>
<pre><code>cd /path/to/cappuccino
ant</code></pre>
<p>To use the freshly built frameworks simply replace the &#8220;Frameworks&#8221; directory in your application with a symbolic link to the Release directory in the directory pointed to by your $STEAM_BUILD environment variable:</p>
<pre><code>cd /path/to/your_application
mv Frameworks Frameworks-Original
ln -s $STEAM_BUILD/Release Frameworks</code></pre>
<p>(if you&#8217;re loading your project through a webserver like Apache make sure to <a href="http://tlrobinson.net/blog/?p=40">enable the FollowSymLinks option</a>)</p>
<h3>objjc</h3>
<p>objjc, the Objective-J compiler, is the most important of the build tools, but you&#8217;ll likely never invoke it directly. objj can take any number of parameters as input filenames and output filenames (preceded by the &#8220;-o&#8221; flag). For example:</p>
<pre><code>objj Class1.j -o Class1.o Class2.j -o Class2.o</code></pre>
<p style="text-align: center;"><img src="http://cappuccino.org/discuss/wp-content/uploads/2008/10/objjc1.png" alt="" title="objjc" width="338" height="76" class="aligncenter size-full wp-image-49" /></p>
<p>This will invoke the Objective-J compiler (which is identical to the one used by Objective-J in the browser) on each input file, outputting JavaScript plus some metadata to each specified output file. Next we need to combine all of these individual output files into a single &#8220;.sj&#8221; archive that contains the JavaScript and import dependency metadata for the entire framework. It would be possible to do this by hand, but steam takes care of it for you.</p>
<h3>steam</h3>
<p>steam is the general Cappuccino build tool that manages the creation and compilation of your Cappuccino applications.</p>
<p>To create a basic Cappuccino application, simply run steam with the &#8220;create&#8221; command:</p>
<pre><code>steam create ApplicationName</code></pre>
<p>This will create a new Cappuccino application in the directory &#8220;ApplicationName&#8221;. This application can be modified and run (by opening index.html in the browser) without any further usage of the build tools.</p>
<p>When you&#8217;re ready to compile the application code for deployment, add a .steam file to your application, like the following:</p>
<div style="text-align:left;color:#000000; background-color:#ffffff; border:solid black 1px; padding:0.5em 1em 0.5em 1em; overflow:auto;font-size:small; font-family:monospace; "><span style="color:#236e25;">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br />
<span style="color:#236e25;">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span><br />
<span style="color:#881280;">&lt;plist </span><span style="color:#994500;">version</span><span style="color:#881280;">=</span><span style="color:#1a1aa6;">&quot;1.0&quot;</span><span style="color:#881280;">&gt;</span><br />
<span style="color:#881280;">&lt;dict&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>Name<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;string&gt;</span>YourApplication<span style="color:#881280;">&lt;/string&gt;</span><br />
&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>Targets<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;<span style="color:#881280;">&lt;array&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;dict&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>Name<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;string&gt;</span>YourApplication<span style="color:#881280;">&lt;/string&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;/dict&gt;</span><br />
&nbsp;&nbsp;<span style="color:#881280;">&lt;/array&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>Configurations<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;<span style="color:#881280;">&lt;array&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;dict&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>Name<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;string&gt;</span>Debug<span style="color:#881280;">&lt;/string&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>Settings<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;dict&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>PREPROCESS<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;true/&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>FLAGS<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;string&gt;</span>-DDEBUG<span style="color:#881280;">&lt;/string&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;/dict&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;/dict&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;dict&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>Name<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;string&gt;</span>Release<span style="color:#881280;">&lt;/string&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>Settings<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;dict&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>PREPROCESS<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;true/&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;key&gt;</span>PREINTERPRET<span style="color:#881280;">&lt;/key&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;true/&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;/dict&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#881280;">&lt;/dict&gt;</span><br />
&nbsp;&nbsp;<span style="color:#881280;">&lt;/array&gt;</span><br />
<span style="color:#881280;">&lt;/dict&gt;</span><br />
<span style="color:#881280;">&lt;/plist&gt;</span></div>
<p>This file defines the targets and configurations for your project. This one defines a single target, YourApplication, and two configurations, Release and Debug. To compile your application, simply execute steam with the build command, the .steam filename, and the configuration name:</p>
<pre><code>steam build -f MyApp.steam -c Release</code></pre>
<p>If a .steam filename is not provided it will look for a file with the extension &#8220;.steam&#8221;. Likewise, if a configuration name is not provided, it will use the first one defined in the file. The following will run the &#8220;Debug&#8221; configuration in your .steam file:</p>
<pre><code>steam build</code></pre>
<p>steam gathers all &#8220;.j&#8221; files in your application, compiles them, and combines them into a single &#8220;.sj&#8221; file (&#8221;static Objective-J&#8221;), along with a new &#8220;Info.plist&#8221; which tell Objective-J which files are contained in the &#8220;.sj&#8221;.</p>
<p style="text-align: center;"><img src="http://cappuccino.org/discuss/wp-content/uploads/2008/10/steam1.png" alt="" title="steam" width="356" height="100" class="aligncenter size-full wp-image-50" /></p>
<p>The results are placed in a subdirectory of $STEAM_BUILD named the same as the configuration, i.e. Debug or Release. Alternatively, pass the &#8220;-b&#8221; flag and a build directory to specify where it should be built.</p>
<p>The compiled application or framework can then be used in place of the original uncompiled collection of .j files. If it was an application, copy or symlink your Frameworks directory to it&#8217;s directory. If it was a framework, copy it to your application&#8217;s Frameworks directory.</p>
<h3>Conclusion</h3>
<p>This article covered the core Cappuccino build tools, objjc and steam. Remember that you will probably never want to call objjc directly, but rather rely on the &#8220;steam build&#8221; command to manage the build process for you. Additionally, remember the build process is entirely optional (except if you&#8217;re editing the Cappuccino frameworks themselves), and is only necessary as a deploy-time optimization.</p>
<p>In subsequent articles we&#8217;ll cover the remaining more advanced build tools, press and bake, as well as further deployment optimizations.</p>
				</div>

				<p class="postmetadata">Tags: <a href="http://cappuccino.org/discuss/tag/build-tool/" rel="tag">build tool</a>, <a href="http://cappuccino.org/discuss/tag/cappuccino/" rel="tag">Cappuccino</a>, <a href="http://cappuccino.org/discuss/tag/objective-j/" rel="tag">Objective-J</a><br /> Posted in <a href="http://cappuccino.org/discuss/category/cappuccino/" title="View all posts in Cappuccino" rel="category tag">Cappuccino</a>,  <a href="http://cappuccino.org/discuss/category/cappuccino/tools/" title="View all posts in Tools" rel="category tag">Tools</a>,  <a href="http://cappuccino.org/discuss/category/tutorials/" title="View all posts in Tutorials" rel="category tag">Tutorials</a> |   <a href="http://cappuccino.org/discuss/2008/10/14/objjc-and-steam/#comments" title="Comment on Cappuccino Tools: &#8220;objjc&#8221; and &#8220;steam&#8221;"></a><noscript><a href="http://cappuccino.disqus.com/?url=http://cappuccino.org/discuss/2008/10/14/objjc-and-steam/">View comments</a></noscript><a href="http://cappuccino.org/discuss/2008/10/14/objjc-and-steam/#disqus_thread">Comments</a></a></p>

			</div>

				<div class="post">
				<h3 id="post-56"><a href="http://cappuccino.org/discuss/2008/10/08/xmlhttprequest-jsonp-cappuccino/" rel="bookmark" title="Permanent Link to XMLHTTPRequest, JSONP &#038; Cappuccino">XMLHTTPRequest, JSONP &#038; Cappuccino</a></h3>
				<small>Wednesday, October 8th, 2008</small>

				<div class="entry">
					<p>If you&#8217;re a veteran web developer, you&#8217;re probably familiar with the XMLHTTPRequest (XHR for short), the bread and butter of &#8220;AJAX&#8221;. XHRs are what make dynamic applications that don&#8217;t reload the page possible. For an application framework like Cappuccino this is critical, since Cappuccino applications are designed to never reload the page &#8212; so it&#8217;s important to understand exactly how Cappuccino deals with these requests.</p>
<p>Before we get in too deep, a quick primer on exactly what I&#8217;m talking about. If you&#8217;re comfortable with XMLHTTPRequests already, feel free to skip this paragraph. <a href="http://en.wikipedia.org/wiki/XMLHttpRequest">XMLHTTPRequest</a> was introduced by Microsoft in Internet Exporer 5 as a way for scripts within a web page to send a remote request to another server without reloading the entire page. Although it started as a propriety Microsoft technology, it was later adopted by Mozilla, and eventually all the other major browsers. The term AJAX, which stands for Asynchronous JavaScript and XML, is essentially synonymous with the use of XMLHTTPRequests on a website. A website creates an XHR object with a specific URL, gives it a function to execute when the status of the request changes, and then executes the request. With this mechanism, your script can use most of the HTTP verbs, and can respond to specific HTTP response codes, which makes it a flexible and powerful API. If you&#8217;re coming from Cocoa, or another desktop programming environment, you may be used to classes that perform similar functions like NSURLConnection or maybe even (approximately) curl and wget. There are, however, important limitations introduced by the browser security model that we&#8217;ll discuss shortly.</p>
<h3>XMLHTTPRequest</h3>
<p>In Objective-J and Cappuccino, asynchronous http requests are instrumental for creating a working app, beginning with the import statement. As you&#8217;ve probably noticed by now, Objective-J introduces the <strong class="keyword">import</strong> keyword to JavaScript. Import statements pull in and execute Objective-J code at runtime, which lets us maintain dependency relationships across classes in Cappuccino, much like code in C or Java. These statements are actually asynchronous, and are implemented using XHRs. This means we only have to include one script tag in our <em>index.html</em> file for Objective-J only, while the rest of Cappuccino is bootstrapped with these asynchronous requests. This is a fairly low level detail, but it illustrates the importance of the XHR when writing complex javascript based applications.</p>
<p>When writing a Cappuccino applications, XHRs are the primary way to communicate with your backend server. While most of your application logic may be running in the client, certain tasks will still need to run on a webserver.  For example, consider an authentication system; in order for authentication to be meaningful, it will need to present credentials to a server for verification. Similarly, features like persistent data storage require server communication to actually store the data, otherwise it would dissappear when the user navigated away from the page. To put it another way, if your app doesn&#8217;t talk to an outside server, it may be of limited utility.</p>
<h3>CPURLConnection</h3>
<p>Like most things in Cappuccino, XMLHTTPRequests are abstracted at a higher level. In this case, the CPURLConnection class manages the communication. If we look at the <a href="http://cappuccino.org/learn/documentation/class_c_p_u_r_l_connection.html">API Reference</a>, we&#8217;ll find a few different ways to create an instance. The easiest way is the class method <strong class="keyword">connectionWithRequest:delegate:</strong>, which takes a CPURLRequest object and a delegate. CPURLRequest objects wrap a single request, including the URL, HTTP method, request body, and request headers. Like everywhere in Cappuccino, the delegate provides for the ability to customize the request&#8217;s behavior. Let&#8217;s look at the process of creating a CPURLConnection.</p>
<pre class="enscript" ><!--BEGIN enscript-->var request = [CPURLRequest requestWithURL:<B><span style="color:#BC8F8F">&quot;list.txt&quot;</span></B>];
var connection = [CPURLConnection connectionWithRequest:request delegate:<B><span style="color:#A020F0">self</span></B>];<!--END enscript--></pre>
<p>As you can see, it&#8217;s a simple process. Connections created with this class method fire immediately, without needing to explicitly call any additional methods.  By default, the request object will be a GET request, with no additional data. Like any URL on a webpage, the URL will be treated as relative to your <em>index.html</em> file unless you specify an absolute path or URL (e.g. preceding the URL with http://). To handle the response, we can implement these two optional delegate methods:</p>
<pre class="enscript" ><!--BEGIN enscript-->
- (<B><span style="color:#228B22">void</span></B>)<B><span style="color:#0000FF">connection</span></B>:(<B><span style="color:#228B22">CPURLConnection</span></B>) <span style="color:#B8860B">connection</span> <B><span style="color:#0000FF">didReceiveData</span></B>:(<B><span style="color:#228B22">CPString</span></B>)<span style="color:#B8860B">data</span>
{
    <I><span style="color:#B22222">//This method is called when a connection receives a response. in a
</span></I>    <I><span style="color:#B22222">//multi-part request, this method will (eventually) be called multiple times,
</span></I>    <I><span style="color:#B22222">//once for each part in the response.
</span></I>}

- (<B><span style="color:#228B22">void</span></B>)<B><span style="color:#0000FF">connection</span></B>:(<B><span style="color:#228B22">CPURLConnection</span></B>)<span style="color:#B8860B">connection</span> <B><span style="color:#0000FF">didFailWithError</span></B>:(<B><span style="color:#228B22">CPString</span></B>)<span style="color:#B8860B">error</span>
{
    <I><span style="color:#B22222">//This method is called if the request fails for any reason.
</span></I>}<!--END enscript--></pre>
<p>After your request is created it will be fired, and later CPURLConnection will call the methods above on the connection&#8217;s delegate. These methods are both optional, but are the minimum that you should implement in order to interact with your AJAX requests. The first is essential in processing any response, and the second is necessary for correctly dealing with errors, which is an important part of a well written application. Let&#8217;s look at a real world implementation of these two methods, as well as the creation of a request, to get a sense for how all this works.</p>
<p>The following code is taken from 280 Slides. It deletes a photo from your library. In this first chunk, we&#8217;ll construct and start our connection:</p>
<pre class="enscript" ><!--BEGIN enscript-->
<I><span style="color:#B22222">//BASE_URL is a 280 Slides global, which points to the base directory of our server structure
</span></I>var request = [CPURLRequest requestWithURL: BASE_URL+<B><span style="color:#BC8F8F">&quot;Media/photo.php?id=&quot;</span></B>+itemID];

<I><span style="color:#B22222">//we're using HTTP verbs to keep our backend as RESTful as possible
</span></I>[request setHTTPMethod: <B><span style="color:#BC8F8F">&quot;DELETE&quot;</span></B>];

<I><span style="color:#B22222">//create the CPURLConnection and store it. the connection fires immediately
</span></I>_deletePhotoConnection = [CPURLConnection connectionWithRequest: request delegate: <B><span style="color:#A020F0">self</span></B>];<!--END enscript--></pre>
<p>Notice that we store a reference to the connection in the ivar <em>_deletePhotoConnection</em>. This is so, if we have multiple connections, we can check to ensure we&#8217;re responding to the right one. Now let&#8217;s look at the delegate method implementations:</p>
<pre class="enscript" ><!--BEGIN enscript-->
- (<B><span style="color:#228B22">void</span></B>)<B><span style="color:#0000FF">connection</span></B>:(<B><span style="color:#228B22">CPURLConnection</span></B>)<span style="color:#B8860B">aConnection</span> <B><span style="color:#0000FF">didReceiveData</span></B>:(<B><span style="color:#228B22">CPString</span></B>)<span style="color:#B8860B">data</span>
{
    <I><span style="color:#B22222">//get a javascript object from the json response
</span></I>    var result = CPJSObjectCreateWithJSON(data);

    <I><span style="color:#B22222">//check if we're talking about the delete connection
</span></I>    <B><span style="color:#A020F0">if</span></B> (aConnection == _deletePhotoConnection)
        [<B><span style="color:#A020F0">self</span></B> deletePhoto:result.<B><span style="color:#A020F0">id</span></B>];   <I><span style="color:#B22222">//deletes the specified photo
</span></I>
    <I><span style="color:#B22222">//clear out this connection's reference
</span></I>    [<B><span style="color:#A020F0">self</span></B> clearConnection:aConnection];
}

- (<B><span style="color:#228B22">void</span></B>)<B><span style="color:#0000FF">connection</span></B>:(<B><span style="color:#228B22">CPURLConnection</span></B>)<span style="color:#B8860B">aConnection</span> <B><span style="color:#0000FF">didFailWithError</span></B>:(<B><span style="color:#228B22">CPError</span></B>)<span style="color:#B8860B">anError</span>
{
    <B><span style="color:#A020F0">if</span></B> (aConnection == _deletePhotoConnection)
        alert(<B><span style="color:#BC8F8F">&quot;There was an error deleting this photo. Please try again in a moment.&quot;</span></B>);

    [<B><span style="color:#A020F0">self</span></B> clearConnection:aConnection];
}

- (<B><span style="color:#228B22">void</span></B>)<B><span style="color:#0000FF">clearConnection</span></B>:(<B><span style="color:#228B22">CPURLConnection</span></B>)<span style="color:#B8860B">aConnection</span>
{
    <I><span style="color:#B22222">//we no longer need to hold on to a reference to this connection
</span></I>    <B><span style="color:#A020F0">if</span></B> (aConnection == _deletePhotoConnection)
        _deletePhotoConnection = <B><span style="color:#A020F0">nil</span></B>;
}<!--END enscript--></pre>
<p>Again, the code is very simple. Since we send and receive data using JSON, the first call in our <strong>connection:didReceiveData:</strong> implementation turns that text response (<em>data</em>) into a javascript object using the JSON helper function <strong>CPJSObjectCreateWithJSON()</strong>. For the reverse operation, you can use the reverse function, <strong>CPJSObjectCreateJSON()</strong>. With the resulting object in hand, we check if the resulting connection is in fact our _deletePhotoConnection, and if it is, we proceed to delete the photo referenced in the object. In the alternate case, where our request is unsuccessful, we prompt the user to inform them that the request failed and do not delete the photo.</p>
<p>You&#8217;ll notice that both methods call <strong>clearConnection:</strong>. This is a convenience method we&#8217;ve written to nil out our reference to the connection object once we&#8217;ve finished using it. Although not strictly necessary, keeping a pointer to the object means it won&#8217;t be collected by the garbage collector. Removing the reference from our instance variable is the best practice since we know we will not be using it again. </p>
<p>Although it&#8217;s not shown here, the reason we store a reference to the specific connection is that we use other connections in the same class, so we need a simple way to tell them apart. If you&#8217;re only using one connection with your delegate, you may not need to use this technique or store a reference to the connection at all.</p>
<p>Finally, there are two additional CPURLConnection delegate methods we chose not to implement, but which you may be interested in for your own application. There&#8217;s also a class delegate for handling request authentication at the application level. You can read more about these methods in the <a href="http://cappuccino.org/learn/documentation/classes/CPURLConnection.html">API documentation</a>. </p>
<h3>CPJSONPConnection</h3>
<p>One of the limitations of the XHR is that it must follow what is known in the web security world as the <a href="http://en.wikipedia.org/wiki/Same_origin_policy">same origin policy</a>. The model requires that requests can only be sent to URLs with the same protocol, domain, and port number as the web page. This policy makes it difficult to interact with third party web services without having to proxy requests first through your own webserver.  Several people developed their own workarounds to the limitation, but eventually <a href="http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/">JSONP</a> emerged as the standard mechanism. </p>
<p>JSONP stands for JSON with Padding, and it comprises two components. The first part deals with getting around the same origin policy itself. XMLHTTPRequests may not work across multiple domains, but &lt;script&gt; tags have no such limitation. JSONP takes advantage of this by  dynamically generating a &lt;script&gt; tag and appending it to the page. The script&#8217;s src property is set to the URL of the remote API, including all request parameters in the query string. The second component of JSONP deals with what to do once the API returns a response.</p>
<p>As the name suggests, JSONP APIs return their data in the JSON format, but instead of returning a plain JSON string, they wrap the JSON response in a function call. This extra function call is the &#8220;padding&#8221; in JSONP, and it effectively works around the browser&#8217;s security policy. Typically, function name is a parameter of the request, which you can see demonstrated in the Flickr API.  This API allows you to specify <em>format=json</em> to get a JSON response, and <em>jsoncallback=myfunctionname</em> to specify your custom function wrapper for the response. An example request might look something like this:</p>
<pre class="enscript" ><!--BEGIN enscript-->
<B><span style="color:#A020F0">var</span></B> url = <B><span style="color:#BC8F8F">&quot;http://www.flickr.com/services/rest/&quot;</span></B>+
          <B><span style="color:#BC8F8F">&quot;?method=flickr.interestingness.getList&quot;</span></B>+
          <B><span style="color:#BC8F8F">&quot;&amp;format=json&amp;jsoncallback=flickResponse&amp;api_key=YOUR_KEY&quot;</span></B>;<!--END enscript--></pre>
<p>As you can imagine, generating your own dynamic script tags and managing global callback methods would be a serious hassle, which is why Cappuccino has built in support in the form of <a href="http://cappuccino.org/learn/documentation/classes/CPJSONPConnection.html">CPJSONPConnection</a>. You may have encountered this class in the source of our <a href="http://cappuccino.org/learn/demos/FlickrPhotoDemo/">Flickr Demo</a>. Creating an instance should look familiar:</p>
<pre class="enscript" ><!--BEGIN enscript-->
var connection = [CPJSONPConnection sendRequest:aRequest callback:aCallbackParameter delegate:<B><span style="color:#A020F0">self</span></B>];<!--END enscript--></pre>
<p>The additional parameter, <strong>callback:</strong>, is a string that specifies the name of the parameter that allows us to specify the callback function&#8217;s name in the JSONP API we&#8217;re talking to. Similar to CPURLConnection, these two delegate methods are defined:</p>
<pre class="enscript" ><!--BEGIN enscript-->
- (<B><span style="color:#228B22">void</span></B>)<B><span style="color:#0000FF">connection</span></B>:(<B><span style="color:#228B22">CPJSONPConnection</span></B>)<span style="color:#B8860B">aConnection</span> <B><span style="color:#0000FF">didReceiveData</span></B>:(<B><span style="color:#228B22">Object</span></B>)<span style="color:#B8860B">data</span>
{
    <I><span style="color:#B22222">//called by the &quot;padding&quot; function when the request is complete
</span></I>
    <I><span style="color:#B22222">//depending on the third part API, data may be the native javascript object,
</span></I>    <I><span style="color:#B22222">//or it may be a string. usually a js object is used, but if a string
</span></I>    <I><span style="color:#B22222">//is passed, you can create a js object with CPJSObjectCreateWithJSON()
</span></I>}

- (<B><span style="color:#228B22">void</span></B>)<B><span style="color:#0000FF">connection</span></B>:(<B><span style="color:#228B22">CPJSONPConnection</span></B>)<span style="color:#B8860B">aConnection</span> <B><span style="color:#0000FF">didFailWithError</span></B>:(<B><span style="color:#228B22">CPString</span></B>)<span style="color:#B8860B">error</span>
{
    <I><span style="color:#B22222">//will be called if the connection fails
</span></I>    <I><span style="color:#B22222">//will see improvements in an upcoming release
</span></I>}<!--END enscript--></pre>
<p>Let&#8217;s take a look at the actual implementation in our Flickr Demo:</p>
<pre class="enscript" ><!--BEGIN enscript-->
- (<B><span style="color:#228B22">void</span></B>)<B><span style="color:#0000FF">applicationDidFinishLaunching</span></B>
{
    ...

    <I><span style="color:#B22222">//Create the request, which contains all of our query parameters,
</span></I>    <I><span style="color:#B22222">//except the jsoncallback parameter
</span></I>
    var req = [CPURLRequest requestWithURL:
                    <B><span style="color:#BC8F8F">&quot;http://www.flickr.com/services/rest/&quot;</span></B>+
                    <B><span style="color:#BC8F8F">&quot;?method=flickr.interestingness.getList&quot;</span></B>+
                    <B><span style="color:#BC8F8F">&quot;&amp;per_page=20&amp;format=json&amp;api_key=&quot;</span></B>+API_KEY];

    <I><span style="color:#B22222">//Create the connection, set the callback, and make ourselves the delegate.
</span></I>    <I><span style="color:#B22222">//the connection fires immediately
</span></I>
    var connection = [CPJSONPConnection sendRequest:req callback:<B><span style="color:#BC8F8F">&quot;jsoncallback&quot;</span></B> delegate:<B><span style="color:#A020F0">self</span></B>];
}

- (<B><span style="color:#228B22">void</span></B>)<B><span style="color:#0000FF">connection</span></B>:(<B><span style="color:#228B22">CPJSONPConnection</span></B>)<span style="color:#B8860B">aConnection</span> <B><span style="color:#0000FF">didReceiveData</span></B>:(<B><span style="color:#228B22">Object</span></B>)<span style="color:#B8860B">data</span>
{
    <I><span style="color:#B22222">//the response from Flickr is the actual JS Object, which has an
</span></I>    <I><span style="color:#B22222">//array of photos that we pass to our collection view
</span></I>    [<B><span style="color:#A020F0">self</span></B> addImageList:data.photos.photo withIdentifier: lastIdentifier];
}

- (<B><span style="color:#228B22">void</span></B>)<B><span style="color:#0000FF">connection</span></B>:(<B><span style="color:#228B22">CPJSONPConnection</span></B>)<span style="color:#B8860B">aConnection</span> <B><span style="color:#0000FF">didFailWithError</span></B>:(<B><span style="color:#228B22">CPString</span></B>)<span style="color:#B8860B">error</span>
{
    <I><span style="color:#B22222">//Ideally, we would do something smarter here.
</span></I>    alert(error);
}<!--END enscript--></pre>
<p>Due to the use of the script tag injection, as opposed to a traditional XHR object, we don&#8217;t have any fine grained information about the response. We cannot detect status codes, and cannot natively access the response. Thankfully, CPJSONPConnection does a good job of managing the additional complexity, and massaging it into a familiar API. There is still some work to be done on generating more reliable errors, but it should be completed in the near future.</p>
<p>JSONP does have it&#8217;s own security implications. Because you&#8217;re essentially allowing arbitrary third party code to execute within the context of your own application, you should only use JSONP with providers you trust. It&#8217;s also important to note that because these requests are sent to different domains, cookies from your own site will not be sent along with the request. This prevents third parties from stealing your sessions, but it also means that authenticating requests is significantly more complex.</p>
<h3>Conclusion</h3>
<p>There&#8217;s been some confusion about when to use CPURLConnection versus CPJSONPConnection, due largely in part to the lack of documentation or discussion on the issue. In general, you should only use JSONP with third-party services that you trust, and only when doing so doesn&#8217;t involve sensitive information. For example, getting public Flickr photos, or performing a Google search using Google&#8217;s AJAX search API. If you&#8217;re communicating with your own service, even if you use JSON as the transmission format, you should use CPURLConnection. Their are numerous advantages to this approach, especially the additional security. </p>
<p>I hope this has illustrated both when and how to use CPURLConnection and CPJSONPConnection. As we continue to develop Cappuccino, we&#8217;ll be improving both of these classes, and introducing new communication methods as well. If you have questions, sound off in the comments, or try the <a href="http://cappuccino.org/discuss/list.php">mailing list or irc channel</a>.</p>
				</div>

				<p class="postmetadata">Tags: <a href="http://cappuccino.org/discuss/tag/ajax/" rel="tag">AJAX</a>, <a href="http://cappuccino.org/discuss/tag/cpurlconnection/" rel="tag">CPURLConnection</a>, <a href="http://cappuccino.org/discuss/tag/tutorial/" rel="tag">tutorial</a>, <a href="http://cappuccino.org/discuss/tag/xmlhttprequest/" rel="tag">XMLHTTPRequest</a><br /> Posted in <a href="http://cappuccino.org/discuss/category/cappuccino/" title="View all posts in Cappuccino" rel="category tag">Cappuccino</a>,  <a href="http://cappuccino.org/discuss/category/tutorials/" title="View all posts in Tutorials" rel="category tag">Tutorials</a> |   <a href="http://cappuccino.org/discuss/2008/10/08/xmlhttprequest-jsonp-cappuccino/#comments" title="Comment on XMLHTTPRequest, JSONP &#038; Cappuccino"></a><noscript><a href="http://cappuccino.disqus.com/?url=http://cappuccino.org/discuss/2008/10/08/xmlhttprequest-jsonp-cappuccino/">View comments</a></noscript><a href="http://cappuccino.org/discuss/2008/10/08/xmlhttprequest-jsonp-cappuccino/#disqus_thread">Comments</a></a></p>

			</div>

				<div class="post">
				<h3 id="post-41"><a href="http://cappuccino.org/discuss/2008/10/06/the-cappuccino-build-tools/" rel="bookmark" title="Permanent Link to The Cappuccino and Objective-J Build Tools">The Cappuccino and Objective-J Build Tools</a></h3>
				<small>Monday, October 6th, 2008</small>

				<div class="entry">
					<p>This article is a high level overview of the current Cappuccino and Objective-J build tools. Subsequent posts will cover each tool in more detail.</p>
<p>One of our primary design goals with Cappuccino and Objective-J was to keep the simple development cycle web developers are used to: edit your code, save, refresh the browser. At the same time we wanted to add powerful language features to JavaScript without requiring the user install a plugin like Flash or Silverlight. At first glance it seemed like only two of these three requirements could be satisfied simultaneously, until we had the key realization that we could simply write our compiler in JavaScript itself, and perform the compilation at runtime on the client.</p>
<p>In reality the Objective-J &#8220;compiler&#8221; is more like a preprocessor, performing a relatively simple transformation from Objective-J code to JavaScript code, which is then interpretted by the browser&#8217;s native JavaScript engine. We don&#8217;t do full parsing and compiling, nor do we have a separate interpreter on top of JavaScript. The result is that the compiler and resulting code run very fast.</p>
<p>This turned out to work great. Simply <a href="http://cappuccino.org/starter">download the starter package</a>, load index.html in your browser, and start editing away! If you&#8217;re just getting started with Objective-J and Cappuccino you don&#8217;t even need to worry about the build tools, they&#8217;re entirely optional.</p>
<p>When it comes time to deploy your application you may want to optimize it. There&#8217;s no reason for your customers to wait any longer than necessary, even if the overhead is minimal. That&#8217;s where the build tools come in. Each tool has a specific purpose, and they all work together to produce an optimized Cappuccino application:</p>
<ul>
<li><strong>objjc</strong> - the Objective-J compiler</li>
<li><strong>steam</strong> - a general tool for managing the build process, creating new Cappuccino applications, etc.</li>
<li><strong>press</strong> - code stripping and other optimizations</li>
<li><strong>bake</strong> - deployment tool</li>
</ul>
<h3>objjc</h3>
<p>At the lowest level is &#8220;objjc&#8221;, the Objective-J compiler. It&#8217;s equivalent to gcc or javac, except it converts Objective-J code to JavaScript. Because we can run the same JavaScript code in the browser and <a href="http://www.mozilla.org/rhino/">Rhino</a> the core of objjc is identical to the in-browser compiler.</p>
<p style="text-align: center;"><a href="http://cappuccino.org/discuss/wp-content/uploads/2008/10/objjc.png"></a><a href="http://cappuccino.org/discuss/wp-content/uploads/2008/10/objjc1.png"><img class="aligncenter size-full wp-image-49" title="objjc" src="http://cappuccino.org/discuss/wp-content/uploads/2008/10/objjc1.png" alt="" width="338" height="76" /></a></p>
<p>Currently objjc&#8217;s implementation is closer to a simple preprocessor than a compiler, much like the original Objective-C compiler was implemented as a preprocessor on top of C. The preprocessor simply looks for the few Objective-J syntax additions and replaces it with the raw JavaScript equivalent. A big reason this is possible is that Objective-J is a strict superset of JavaScript, thus all JavaScript code is valid Objective-J code.</p>
<p>Typically you don&#8217;t call objjc directly, but rather let steam manage the build process.</p>
<h3>steam</h3>
<p>Next up is steam, which is the main Objective-J and Cappuccino build tool. Currently it serves two purposes: &#8220;steam build&#8221; (similar to Xcode&#8217;s &#8220;xcodebuild&#8221;) and &#8220;steam create&#8221; (similar to Ruby on Rail&#8217;s &#8220;rails&#8221; command).</p>
<p>&#8220;steam build&#8221; runs the compilation process on an entire application or framework and outputs a single &#8220;.sj&#8221; file, vastly decreasing the number of HTTP requests required to load an application. These &#8220;.sj&#8221; files are archives of the compiled input &#8220;.j&#8221; files, along with information detailing each file&#8217;s required imports. This allows the Objective-J loading system to efficiently and asynchronously load a large application.</p>
<p style="text-align: center;"><a href="http://cappuccino.org/discuss/wp-content/uploads/2008/10/steam.png"></a><a href="http://cappuccino.org/discuss/wp-content/uploads/2008/10/steam1.png"><img class="aligncenter size-full wp-image-50" title="steam" src="http://cappuccino.org/discuss/wp-content/uploads/2008/10/steam1.png" alt="" width="356" height="100" /></a></p>
<p>&#8220;steam create&#8221; copies all the files required for a new project to the directory specified.</p>
<h3>press</h3>
<p>The &#8220;press&#8221; tool takes in a full application and attempts to determine which code files are unecessary. It then strips those files and writes the results to another directory. This could be thought of as a &#8220;linker&#8221; though it works very differently than a traditional linker. On a simple project it will reduce the AppKit and Foundation frameworks size by approximately 30%, and we expect further improvements.</p>
<p style="text-align: center;"><a href="http://cappuccino.org/discuss/wp-content/uploads/2008/10/press.png"></a><a href="http://cappuccino.org/discuss/wp-content/uploads/2008/10/press1.png"><img class="aligncenter size-full wp-image-51" title="press" src="http://cappuccino.org/discuss/wp-content/uploads/2008/10/press1.png" alt="" width="356" height="98" /></a></p>
<p>Optionally, it can run the <a href="http://pmt.sourceforge.net/pngcrush/">pngcrush</a> utility on all your png graphics, attempting to reduce their size. Eventually press will also automatically sprite images, further reducing the number of HTTP requests required to load your images.</p>
<h3>bake</h3>
<p>Finally, we have &#8220;bake&#8221;, the Cappuccino deployment tool (like <a href="http://www.capify.org/">&#8220;Capistrano&#8221;</a> but specialized for Cappuccino applications). Bake orchestrates all the above tools to produce, and optionally deploy, a highly optimized Cappuccino application. First it can pull both Cappuccino and your application code from git, svn, or a local or remote directory via rsync.</p>
<p><a href="http://cappuccino.org/discuss/wp-content/uploads/2008/10/bake1.png"><img class="alignright size-full wp-image-44" style="float: right;" title="bake1" src="http://cappuccino.org/discuss/wp-content/uploads/2008/10/bake1.png" alt="" width="382" height="698" /></a>It then copies pieces of the various &#8220;checkouts&#8221; to the &#8220;products&#8221; directory, first running a build process like &#8220;steam&#8221; or ant, if specified. For example, it can run steam on your application code, and copy the results to the product directory, then do the same for AppKit and Foundation, copying the results to the Frameworks/AppKit and Frameworks/Foundation directories to build the complete application.</p>
<p>Once an application is assembled, bake can run &#8220;press&#8221;, optimizing the application&#8217;s size.</p>
<p>Then bake sets up a directory structure and index.html file which allows for several important tricks: aggressive caching, keeping the client application in sync with the server backend, and atomic deployments, all while preserving a single user-facing URL for the application.</p>
<p>Finally, the application is archived and gzipped, scp&#8217;d to one or more servers, and atomically deployed to the specified path(s).</p>
<h3>Conclusion</h3>
<p>Cappuccino&#8217;s build tools are great at optimizing your deployed application, but there are further web server specific optimizations possible as well, including enabling <a href="http://httpd.apache.org/docs/2.0/mod/mod_deflate.html">gzipping</a> and caching. These will be discussed in subsequent articles.</p>
				</div>

				<p class="postmetadata">Tags: <a href="http://cappuccino.org/discuss/tag/build-tool/" rel="tag">build tool</a>, <a href="http://cappuccino.org/discuss/tag/cappuccino/" rel="tag">Cappuccino</a>, <a href="http://cappuccino.org/discuss/tag/objective-j/" rel="tag">Objective-J</a><br /> Posted in <a href="http://cappuccino.org/discuss/category/cappuccino/" title="View all posts in Cappuccino" rel="category tag">Cappuccino</a>,  <a href="http://cappuccino.org/discuss/category/cappuccino/tools/" title="View all posts in Tools" rel="category tag">Tools</a>,  <a href="http://cappuccino.org/discuss/category/tutorials/" title="View all posts in Tutorials" rel="category tag">Tutorials</a> |   <a href="http://cappuccino.org/discuss/2008/10/06/the-cappuccino-build-tools/#comments" title="Comment on The Cappuccino and Objective-J Build Tools"></a><noscript><a href="http://cappuccino.disqus.com/?url=http://cappuccino.org/discuss/2008/10/06/the-cappuccino-build-tools/">View comments</a></noscript><a href="http://cappuccino.org/discuss/2008/10/06/the-cappuccino-build-tools/#disqus_thread">Comments</a></a></p>

			</div>

		
	<script type="text/javascript">
	(function() {
		var links = document.getElementsByTagName('a');
		var query = '?';
		for(var i = 0; i < links.length; i++) {
			if(links[i].href.indexOf('#disqus_thread') >= 0) {
				links[i].innerHTML = 'View Comments';
				query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
			}
		}
		document.write('<script type="text/javascript" src="http://disqus.com/forums/cappuccino/get_num_replies.js' + query + '"><' + '/script>');
	})();
	</script>

	
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"><a href="http://cappuccino.org/discuss/category/tutorials/" >Newer Entries &raquo;</a></div>
		</div>

	        
        </div>
        
        <div style="clear:both;"></div>

        </div>
	</div>


    
    <div id="footerWrapper">
        <div id="footerContent">
            <div class="footerNavSection">
                <h4><a href="/learn">Learn</a></h4>
                <ul>
                    <li><a href="/learn">About Cappuccino</a></li>
                    <li><a href="/learn/demos">Demos</a></li>
                    <li><a href="/learn/tutorials">Tutorials</a></li>
                    <li><a href="/learn/documentation/">Documentation</a></li>
                                    </ul>
            </div>
            <div class="footerNavSection">
                <h4><a href="/discuss">Discuss</a></h4>
                <ul>
                    <li><a href="/discuss">Cappuccino Blog</a></li>
                    <li><a href="http://www.reddit.com/r/Cappuccino/">Latest News</a></li>
                    <li><a href="/discuss/events/">Events</a></li>
                    <li><a href="/discuss/list.php">Mailing List &amp; IRC</a></li>
                    <li><a href="/discuss/faq.php">Frequently Asked Questions</a></li>
                </ul>
            </div>
            <div class="footerNavSection">
                <h4><a href="/contribute">Contribute</a></h4>
                <ul>
                    <li><a href="http://github.com/280north/cappuccino">Source Code</a></li>
                    <li><a href="http://github.com/280north/cappuccino/issues">Bug Tracking</a></li>
                    <li><a href="http://github.com/280north/cappuccino/wikis">Wiki</a></li>
                    <li><a href="http://contributors.cappuccino.org/">Contributors</a></li>
                    <li><a href="http://github.com/280north/cappuccino/wikis/projects-to-work-on">Projects to Work On</a></li>
                </ul>
            </div>
            <div class="footerNavSection">
                <h4><a href="/download">Download</a></h4>
                <p>Cappuccino and Objective-J are licensed under the <a href="/learn/lgpl.txt">LGPL</a>.
                For more information, see our <a href="/learn/licensing.php">licensing page</a>.</p>
            </div>
            
            <div id="copyrightInfo">
                Copyright &copy; 2009 - <a href="http://280north.com">280 North, Inc.</a>  
                Cappuccino and Objective-J are registered Trademarks of 280 North.
                <!--<a href="#">Legal Information</a>.-->
                <a href="http://madebysofa.com"><img src="/images/minisofa.png" alt="" /></a>
                Logo by <a href="http://madebysofa.com">Sofa</a>. 
                Hosting by <a href="http://slicehost.com">Slicehost</a>.
            </div>
        </div>
    </div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3877734-4");
pageTracker._trackPageview();
</script>

</body>
</html>
    
    		
</body>
</html>
<!-- Dynamic Page Served (once) in 0.952 seconds -->
